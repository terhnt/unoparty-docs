"use strict";(self.webpackChunkunoparty_docs=self.webpackChunkunoparty_docs||[]).push([[596],{3905:function(e,n,t){t.d(n,{Zo:function(){return d},kt:function(){return m}});var a=t(7294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var s=a.createContext({}),u=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},d=function(e){var n=u(e.components);return a.createElement(s.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},c=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),c=u(t),m=i,k=c["".concat(s,".").concat(m)]||c[m]||p[m]||o;return t?a.createElement(k,r(r({ref:n},d),{},{components:t})):a.createElement(k,r({ref:n},d))}));function m(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var o=t.length,r=new Array(o);r[0]=c;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,r[1]=l;for(var u=2;u<o;u++)r[u]=t[u];return a.createElement.apply(null,r)}return a.createElement.apply(null,t)}c.displayName="MDXCreateElement"},922:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return u},assets:function(){return d},toc:function(){return p},default:function(){return m}});var a=t(7462),i=t(3366),o=(t(7294),t(3905)),r=["components"],l={sidebar_position:4,id:"administration"},s="Node Administration",u={unversionedId:"advanced/unonode/administration",id:"advanced/unonode/administration",title:"Node Administration",description:"Administration\u200b",source:"@site/docs/advanced/unonode/administration.md",sourceDirName:"advanced/unonode",slug:"/advanced/unonode/administration",permalink:"/unoparty-docs/docs/advanced/unonode/administration",editUrl:"https://github.com/terhnt/unoparty-docs/tree/main/packages/create-docusaurus/templates/shared/docs/advanced/unonode/administration.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4,id:"administration"},sidebar:"advanced",previous:{title:"Installation",permalink:"/unoparty-docs/docs/advanced/unonode/installation"},next:{title:"Unowallet-Specific",permalink:"/unoparty-docs/docs/advanced/unonode/unowallet"}},d={},p=[{value:"Administration\u200b",id:"administration",level:2},{value:"Checking status\u200b",id:"checking-status",level:3},{value:"Modifying configurations\u200b",id:"modifying-configurations",level:3},{value:"Viewing/working with stored data\u200b",id:"viewingworking-with-stored-data",level:3},{value:"Viewing logs\u200b",id:"viewing-logs",level:3},{value:"Service Names",id:"service-names",level:4},{value:"Stopping and restarting containers\u200b",id:"stopping-and-restarting-containers",level:3},{value:"Issuing a single shell command\u200b",id:"issuing-a-single-shell-command",level:3},{value:"Updating, rebuilding, uninstalling\u200b",id:"updating-rebuilding-uninstalling",level:2},{value:"Reparsing blockchain data\u200b",id:"reparsing-blockchain-data",level:3},{value:"Rebuilding a service container\u200b",id:"rebuilding-a-service-container",level:3},{value:"Uninstalling\u200b",id:"uninstalling",level:3},{value:"Component development\u200b",id:"component-development",level:2},{value:"Other Developer Notes\u200b",id:"other-developer-notes",level:3}],c={toc:p};function m(e){var n=e.components,t=(0,i.Z)(e,r);return(0,o.kt)("wrapper",(0,a.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"node-administration"},"Node Administration"),(0,o.kt)("h2",{id:"administration"},"Administration",(0,o.kt)("a",{parentName:"h2",href:"#administration"},"\u200b")),(0,o.kt)("h3",{id:"checking-status"},"Checking status",(0,o.kt)("a",{parentName:"h3",href:"#checking-status"},"\u200b")),(0,o.kt)("p",null,"To check the status of the containers, run:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"unonode ps\n")),(0,o.kt)("h3",{id:"modifying-configurations"},"Modifying configurations",(0,o.kt)("a",{parentName:"h3",href:"#modifying-configurations"},"\u200b")),(0,o.kt)("p",null,"Configuration files for the ",(0,o.kt)("inlineCode",{parentName:"p"},"unobtanium"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"unoparty")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"unoblock")," services are stored under ",(0,o.kt)("inlineCode",{parentName:"p"},"unonode/config/")," and may be freely edited. The various locations are as follows:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"unobtanium"),": See ",(0,o.kt)("inlineCode",{parentName:"li"},"unonode/config/unobtanium/unobtanium.conf")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"unobtanium-testnet"),": See ",(0,o.kt)("inlineCode",{parentName:"li"},"unonode/config/unobtanium/unobtanium.testnet.conf")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"unoparty"),": See ",(0,o.kt)("inlineCode",{parentName:"li"},"unonode/config/unoparty/server.conf")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"unoparty-testnet"),": See ",(0,o.kt)("inlineCode",{parentName:"li"},"unonode/config/unoparty/server.testnet.conf")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"unoblock"),": See ",(0,o.kt)("inlineCode",{parentName:"li"},"unonode/config/unoblock/server.conf")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"unoblock-testnet"),": See ",(0,o.kt)("inlineCode",{parentName:"li"},"unonode/config/unoblock/server.testnet.conf")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"redis"),": shared service used for both mainnet and testnet"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"mongodb"),": shared service used for both mainnet and testnet")),(0,o.kt)("p",null,"Remember: once done editing a configuration file, you must ",(0,o.kt)("inlineCode",{parentName:"p"},"restart")," the corresponding service. Also, please don't change port or usernames/passwords if the configuration files unless you know what you are doing (as the services are coded to work together smoothly with specific values)."),(0,o.kt)("p",null,"For example, a user with base setup (Unobtanium Core & Unoparty Server) could make Unoparty use existing Unobtanium Core by changing configuration files found under unonode/config/unoparty/ (",(0,o.kt)("inlineCode",{parentName:"p"},"backend-connect")," in Unoparty server configuration files and ",(0,o.kt)("inlineCode",{parentName:"p"},"wallet-connect")," in client configuration files.) At this point Unobtanium Core (mainnet and/or testnet) container(s) could be stopped and unoparty server container restarted. If your existing Unobtanium Server allows RPC connections, with proper settings and correct RPC credentials in their configuration files, unoparty (server), unoblock and unowallet can all use it so that you don't have to run unobtanium or unobtanium-testnet container."),(0,o.kt)("h3",{id:"viewingworking-with-stored-data"},"Viewing/working with stored data",(0,o.kt)("a",{parentName:"h3",href:"#viewingworking-with-stored-data"},"\u200b")),(0,o.kt)("p",null,"The various services use ",(0,o.kt)("a",{parentName:"p",href:"https://docs.docker.com/engine/tutorials/dockervolumes/"},"Docker named volumes")," to store data that is meant to be persistent:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"unobtanium")," and ",(0,o.kt)("inlineCode",{parentName:"li"},"unobtanium-testnet"),": Stores blockchain data in the ",(0,o.kt)("inlineCode",{parentName:"li"},"unonode_unobtanium-data")," volume"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"addrindexrs_uno")," and ",(0,o.kt)("inlineCode",{parentName:"li"},"addrindexrs_uno-testnet"),": Stores index data in the ",(0,o.kt)("inlineCode",{parentName:"li"},"unonode_addrindexrs_uno-data")," volume"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"unoparty")," and ",(0,o.kt)("inlineCode",{parentName:"li"},"unoparty-testnet"),": Stores Unoparty databases in the ",(0,o.kt)("inlineCode",{parentName:"li"},"unonode_unoparty-data")," volume"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"unoblock")," and ",(0,o.kt)("inlineCode",{parentName:"li"},"unoblock-testnet"),": Stores Unoblock asset info (images), etc in the ",(0,o.kt)("inlineCode",{parentName:"li"},"unonode_unoblock-data")," volume"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"mongodb"),": Stores the databases for ",(0,o.kt)("inlineCode",{parentName:"li"},"unoblock")," and ",(0,o.kt)("inlineCode",{parentName:"li"},"unoblock-testnet")," in the ",(0,o.kt)("inlineCode",{parentName:"li"},"unonode_mongodb-data")," volume")),(0,o.kt)("p",null,"Use ",(0,o.kt)("inlineCode",{parentName:"p"},"docker volume inspect <volume-name>")," to display volume location. See ",(0,o.kt)("inlineCode",{parentName:"p"},"docker volume --help")," for help on how to interact with Docker volumes."),(0,o.kt)("h3",{id:"viewing-logs"},"Viewing logs",(0,o.kt)("a",{parentName:"h3",href:"#viewing-logs"},"\u200b")),(0,o.kt)("p",null,"To tail the logs, use the following command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"unonode tail <service>\n")),(0,o.kt)("p",null,"Or, to view the entire log, run:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"unonode logs <service>\n")),(0,o.kt)("h4",{id:"service-names"},"Service Names"),(0,o.kt)("p",null,"Where ",(0,o.kt)("inlineCode",{parentName:"p"},"<service>")," may be one the following, or blank to tail all services:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"unoparty")," (",(0,o.kt)("inlineCode",{parentName:"li"},"unoparty-server")," mainnet)"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"unoblock")," (",(0,o.kt)("inlineCode",{parentName:"li"},"unoblock")," mainnet)"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"unobtanium")," (",(0,o.kt)("inlineCode",{parentName:"li"},"unobtanium")," mainnet)"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"addrindexrs_uno")," (",(0,o.kt)("inlineCode",{parentName:"li"},"addrindexrs_uno")," mainnet)"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"armory_utxsvr")," (",(0,o.kt)("inlineCode",{parentName:"li"},"armory_utxsvr")," mainnet)"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"unoparty-testnet")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"unoblock-testnet")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"unobtanium-testnet")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"addrindexrs_uno-testnet")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"armory_utxsvr-testnet")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"unowallet"))),(0,o.kt)("h3",{id:"stopping-and-restarting-containers"},"Stopping and restarting containers",(0,o.kt)("a",{parentName:"h3",href:"#stopping-and-restarting-containers"},"\u200b")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"unonode stop <service>\nunonode start <service>\nunonode restart <service>\n")),(0,o.kt)("p",null,"Where ",(0,o.kt)("inlineCode",{parentName:"p"},"<service>")," is one of the service names listed ",(0,o.kt)("a",{parentName:"p",href:"#service-names"},"above"),", or blank for all services."),(0,o.kt)("p",null,"Note that redis and mongodb are shared services and need to run if either (mainnet or testnet) unoblock container is running and shut down only if both unoblock containers are not running."),(0,o.kt)("h3",{id:"issuing-a-single-shell-command"},"Issuing a single shell command",(0,o.kt)("a",{parentName:"h3",href:"#issuing-a-single-shell-command"},"\u200b")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"unonode exec <service> <CMD>\n")),(0,o.kt)("p",null,"Where ",(0,o.kt)("inlineCode",{parentName:"p"},"<service>")," is one of the service names listed ",(0,o.kt)("a",{parentName:"p",href:"#service-names"},"above"),", and ",(0,o.kt)("inlineCode",{parentName:"p"},"<CMD>")," is an arbitrary shell command."),(0,o.kt)("p",null,"For example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"unonode exec unoparty unoparty-client send --source=uVVuwXm2mDK9pr9XkWT5k7ihQyoSC8y2MW --destination=uVjbsx6tAhySeJpN7xLBieAzWcD7rEVmYp --quantity=1.5 --asset=XUP\nunonode exec unobtanium-testnet unobtanium-cli getpeerinfo\nunonode exec unoblock ls /root\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Getting a shell in a conainer")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"unonode shell <service>\n")),(0,o.kt)("p",null,"Where ",(0,o.kt)("inlineCode",{parentName:"p"},"<service>")," is one of the service names listed ",(0,o.kt)("a",{parentName:"p",href:"#service-names"},"above"),"."),(0,o.kt)("h2",{id:"updating-rebuilding-uninstalling"},"Updating, rebuilding, uninstalling",(0,o.kt)("a",{parentName:"h2",href:"#updating-rebuilding-uninstalling"},"\u200b")),(0,o.kt)("p",null,"To pull the newest software from the git repositories and restart the appropriate daemon, issue the following command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"unonode update <service>\n")),(0,o.kt)("p",null,"Where ",(0,o.kt)("inlineCode",{parentName:"p"},"<service>")," is one of the following, or blank for all applicable services:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"unoparty")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"unoparty-testnet")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"unoblock")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"unoblock-testnet")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"armory_utxsvr")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"armory_utxsvr-testnet")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"unowallet"))),(0,o.kt)("h3",{id:"reparsing-blockchain-data"},"Reparsing blockchain data",(0,o.kt)("a",{parentName:"h3",href:"#reparsing-blockchain-data"},"\u200b")),(0,o.kt)("p",null,"Both ",(0,o.kt)("inlineCode",{parentName:"p"},"unoparty-server")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"unoblock")," read in blockchain data and construct their own internal databases. To reset these databases and trigger a reparse of this blockchain data for one of the services, run:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"unonode reparse <service>\n")),(0,o.kt)("p",null,"Where service is ",(0,o.kt)("inlineCode",{parentName:"p"},"unoparty"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"unoparty-testnet"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"unoblock"),", or ",(0,o.kt)("inlineCode",{parentName:"p"},"unoblock-testnet"),"."),(0,o.kt)("h3",{id:"rebuilding-a-service-container"},"Rebuilding a service container",(0,o.kt)("a",{parentName:"h3",href:"#rebuilding-a-service-container"},"\u200b")),(0,o.kt)("p",null,"As a more extensive option, if you want to remove, rebuild and reinstall a container (downloading the newest container image/",(0,o.kt)("inlineCode",{parentName:"p"},"Dockerfile")," and utilizing that):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"unonode rebuild <service>\n")),(0,o.kt)("p",null,"Where ",(0,o.kt)("inlineCode",{parentName:"p"},"<service>")," is one of the service names listed ",(0,o.kt)("a",{parentName:"p",href:"#service-names"},"earlier"),", or blank for all services. Note that you are just looking to update the source code and restart the service, ",(0,o.kt)("inlineCode",{parentName:"p"},"update")," is a better option."),(0,o.kt)("h3",{id:"uninstalling"},"Uninstalling",(0,o.kt)("a",{parentName:"h3",href:"#uninstalling"},"\u200b")),(0,o.kt)("p",null,"To uninstall the entire unonode setup, run:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"unonode uninstall\n")),(0,o.kt)("h2",{id:"component-development"},"Component development",(0,o.kt)("a",{parentName:"h2",href:"#component-development"},"\u200b")),(0,o.kt)("p",null,"The system allows for easy development and modification of the Unoparty software components. To do so, simply update code in the directories under ",(0,o.kt)("inlineCode",{parentName:"p"},"unonode/src/")," as you see fit. These directories are mapped into the appropriate containers, overlaying (overriding) the source code that the container ships with. This, along with symlinked (develop) Python package installations makes it possible to work on code in-place, with just a service restart necessary to have the changes take effect."),(0,o.kt)("p",null,"Once done updating the source code for a particular service, issue the following command(s) to restart the container with the new code:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"unonode restart <service>\n")),(0,o.kt)("p",null,"Where ",(0,o.kt)("inlineCode",{parentName:"p"},"<service>")," is one of the services mentioned ",(0,o.kt)("a",{parentName:"p",href:"#service-names"},"here"),"."),(0,o.kt)("h3",{id:"other-developer-notes"},"Other Developer Notes",(0,o.kt)("a",{parentName:"h3",href:"#other-developer-notes"},"\u200b")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"To run the ",(0,o.kt)("inlineCode",{parentName:"li"},"unoparty-lib")," test suite, execute:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'unonode exec unoparty "cd /unoparty-lib/unopartylib; py.test --verbose --skiptestbook=all --cov-config=../.coveragerc --cov-report=term-missing --cov=./"\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"If you are working on ",(0,o.kt)("inlineCode",{parentName:"p"},"unowallet"),", you should browse the system using the ",(0,o.kt)("inlineCode",{parentName:"p"},"/src/")," subdirectory (e.g. ",(0,o.kt)("inlineCode",{parentName:"p"},"https://myunowallet.bla/src/"),"). This avoids using precompiled sources. Once you are happy with your changes and ready to make them available to everyone that hits the server, run ",(0,o.kt)("inlineCode",{parentName:"p"},"unonode update unowallet"),", which will pull the newest repo code and repackage the web assets so that the code updates are then active from ",(0,o.kt)("inlineCode",{parentName:"p"},"https://myunowallet.bla/"),".")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Note that when you install the federated node system, HTTPS repository URLs are used by default for all of the repositories checked out under ",(0,o.kt)("inlineCode",{parentName:"p"},"src")," by ",(0,o.kt)("inlineCode",{parentName:"p"},"unonode.py"),". To use SSH URIs instead, specify the ",(0,o.kt)("inlineCode",{parentName:"p"},"--use-ssh-uris")," to the ",(0,o.kt)("inlineCode",{parentName:"p"},"unonode install")," command."))))}m.isMDXComponent=!0}}]);